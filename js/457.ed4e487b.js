"use strict";(self["webpackChunkmeiban_app"]=self["webpackChunkmeiban_app"]||[]).push([[457],{2457:(e,t,n)=>{n.d(t,{A:()=>We});n(8706),n(4782),n(2010),n(9868);var o=n(6768),a=n(4232),r={class:"star-chart-container"},i={class:"chart-header"},s={class:"chart-controls"},c={class:"chart-wrapper"},l=["width","height","viewBox"],u=["cx","cy","r"],d={class:"zodiac-ring"},p={key:0,class:"house-ring"},h={class:"planet-ring"},v={key:1,class:"aspect-lines"},g=["cx","cy","r"],y={class:"axis-lines"},f=["x1","y1","x2","y2"],m=["x1","y1","x2","y2"],x={class:"tooltip-title"},b={class:"tooltip-position"},k={class:"chart-legend"},M={class:"legend-section"},R={class:"legend-items"},P={class:"planet-name"},E={class:"planet-position"},A={key:0,class:"legend-section"},L={class:"legend-items"},w={class:"aspect-description"},D={class:"aspect-orb"};function C(e,t,n,C,W,z){var H=(0,o.g2)("ZodiacSector"),_=(0,o.g2)("HouseSector"),F=(0,o.g2)("PlanetMarker"),N=(0,o.g2)("AspectLine");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",i,[t[2]||(t[2]=(0,o.Lk)("h3",{class:"chart-title"},"星盤圖",-1)),(0,o.Lk)("div",s,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=function(){return C.toggleAspects&&C.toggleAspects.apply(C,arguments)}),class:(0,a.C4)([{active:C.showAspects},"control-btn"])},(0,a.v_)(C.showAspects?"隐藏相位":"显示相位"),3),(0,o.Lk)("button",{onClick:t[1]||(t[1]=function(){return C.toggleHouses&&C.toggleHouses.apply(C,arguments)}),class:(0,a.C4)([{active:C.showHouses},"control-btn"])},(0,a.v_)(C.showHouses?"隐藏宫位":"显示宫位"),3)])]),(0,o.Lk)("div",c,[((0,o.uX)(),(0,o.CE)("svg",{width:C.chartSize,height:C.chartSize,viewBox:"0 0 ".concat(C.chartSize," ").concat(C.chartSize),class:"star-chart-svg"},[(0,o.Lk)("circle",{cx:C.center,cy:C.center,r:C.settings.outerRadius,class:"chart-background"},null,8,u),(0,o.Lk)("g",d,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chartData.zodiac,(function(e){return(0,o.uX)(),(0,o.Wv)(H,{key:e.name,zodiac:e,center:C.center,"inner-radius":C.settings.zodiacRadius-20,"outer-radius":C.settings.outerRadius},null,8,["zodiac","center","inner-radius","outer-radius"])})),128))]),C.showHouses&&C.chartData.houses.length>0?((0,o.uX)(),(0,o.CE)("g",p,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chartData.houses,(function(e){return(0,o.uX)(),(0,o.Wv)(_,{key:e.number,house:e,center:C.center,"inner-radius":C.settings.houseRadius-20,"outer-radius":C.settings.zodiacRadius-20},null,8,["house","center","inner-radius","outer-radius"])})),128))])):(0,o.Q3)("",!0),(0,o.Lk)("g",h,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chartData.planets,(function(e){return(0,o.uX)(),(0,o.Wv)(F,{key:e.id,planet:e,center:C.center,radius:C.settings.planetRadius,onPlanetHover:C.onPlanetHover},null,8,["planet","center","radius","onPlanetHover"])})),128))]),C.showAspects?((0,o.uX)(),(0,o.CE)("g",v,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chartData.aspects,(function(e,t){return(0,o.uX)(),(0,o.Wv)(N,{key:t,aspect:e,planets:C.chartData.planets,center:C.center,radius:C.settings.innerRadius+30},null,8,["aspect","planets","center","radius"])})),128))])):(0,o.Q3)("",!0),(0,o.Lk)("circle",{cx:C.center,cy:C.center,r:C.settings.innerRadius,class:"chart-center"},null,8,g),(0,o.Lk)("g",y,[(0,o.Lk)("line",{x1:C.center-C.settings.outerRadius,y1:C.center,x2:C.center+C.settings.outerRadius,y2:C.center,class:"axis-line"},null,8,f),(0,o.Lk)("line",{x1:C.center,y1:C.center-C.settings.outerRadius,x2:C.center,y2:C.center+C.settings.outerRadius,class:"axis-line"},null,8,m)])],8,l)),C.hoveredPlanet?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"planet-tooltip",style:(0,a.Tr)(C.tooltipStyle)},[(0,o.Lk)("div",x,(0,a.v_)(C.hoveredPlanet.name),1),(0,o.Lk)("div",b,(0,a.v_)(C.hoveredPlanet.sign)+" "+(0,a.v_)(C.hoveredPlanet.signDegree)+"°"+(0,a.v_)(C.hoveredPlanet.signMinute)+"' ",1)],4)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",k,[(0,o.Lk)("div",M,[t[3]||(t[3]=(0,o.Lk)("h4",null,"行星",-1)),(0,o.Lk)("div",R,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chartData.planets,(function(e){return(0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"legend-item"},[(0,o.Lk)("span",{class:"planet-symbol",style:(0,a.Tr)({color:e.color})},(0,a.v_)(e.symbol),5),(0,o.Lk)("span",P,(0,a.v_)(e.displayName),1),(0,o.Lk)("span",E,(0,a.v_)(e.sign)+" "+(0,a.v_)(e.signDegree)+"°"+(0,a.v_)(e.signMinute)+"' ",1)])})),128))])]),C.showAspects&&C.chartData.aspects.length>0?((0,o.uX)(),(0,o.CE)("div",A,[t[4]||(t[4]=(0,o.Lk)("h4",null,"主要相位",-1)),(0,o.Lk)("div",L,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.chartData.aspects.slice(0,5),(function(e,t){return(0,o.uX)(),(0,o.CE)("div",{key:t,class:"legend-item"},[(0,o.Lk)("span",{class:"aspect-color",style:(0,a.Tr)({backgroundColor:e.color})},null,4),(0,o.Lk)("span",w,(0,a.v_)(e.planet1)+" "+(0,a.v_)(e.aspect)+" "+(0,a.v_)(e.planet2),1),(0,o.Lk)("span",D,(0,a.v_)(e.orb.toFixed(1))+"°",1)])})),128))])])):(0,o.Q3)("",!0)])])}n(2892);var W=n(144),z=n(3604),H=n(8653),_=(n(6280),n(6918),n(5276),n(2062),n(4114),n(6099),n(8041),[{name:"白羊座",symbol:"♈",startDegree:0,color:"#FF6B6B"},{name:"金牛座",symbol:"♉",startDegree:30,color:"#4ECDC4"},{name:"双子座",symbol:"♊",startDegree:60,color:"#45B7D1"},{name:"巨蟹座",symbol:"♋",startDegree:90,color:"#96CEB4"},{name:"狮子座",symbol:"♌",startDegree:120,color:"#FFEAA7"},{name:"处女座",symbol:"♍",startDegree:150,color:"#DDA0DD"},{name:"天秤座",symbol:"♎",startDegree:180,color:"#98D8C8"},{name:"天蝎座",symbol:"♏",startDegree:210,color:"#F7DC6F"},{name:"射手座",symbol:"♐",startDegree:240,color:"#BB8FCE"},{name:"摩羯座",symbol:"♑",startDegree:270,color:"#85C1E9"},{name:"水瓶座",symbol:"♒",startDegree:300,color:"#F8C471"},{name:"双鱼座",symbol:"♓",startDegree:330,color:"#82E0AA"}]),F={sun:{symbol:"☉",displayName:"太阳",color:"#FFD700"},moon:{symbol:"☽",displayName:"月亮",color:"#C0C0C0"},mercury:{symbol:"☿",displayName:"水星",color:"#87CEEB"},venus:{symbol:"♀",displayName:"金星",color:"#FFC0CB"},mars:{symbol:"♂",displayName:"火星",color:"#FF6347"},jupiter:{symbol:"♃",displayName:"木星",color:"#DAA520"},saturn:{symbol:"♄",displayName:"土星",color:"#2F4F4F"},uranus:{symbol:"♅",displayName:"天王星",color:"#4FD0E3"},neptune:{symbol:"♆",displayName:"海王星",color:"#4169E1"},pluto:{symbol:"♇",displayName:"冥王星",color:"#8B4513"}};function N(e){return(90-e+360)%360}function X(e){var t=["白羊座","金牛座","双子座","巨蟹座","狮子座","处女座","天秤座","天蝎座","射手座","摩羯座","水瓶座","双鱼座"],n=t.indexOf(e.sign);return-1===n?0:30*n+e.degree+e.minute/60}function I(){return _.map((function(e){return(0,H.A)((0,H.A)({},e),{},{svgAngle:N(e.startDegree),endDegree:e.startDegree+30,midDegree:e.startDegree+15})}))}function S(e){for(var t=[],n=1;n<=12;n++){var o=(e+30*(n-1))%360;t.push({number:n,startDegree:o,endDegree:(o+30)%360,midDegree:(o+15)%360,svgAngle:N(o)})}return t}function q(e){var t=[];return e.sun&&t.push((0,H.A)((0,H.A)({id:"sun"},F.sun),{},{degree:e.sun.longitude||X(e.sun),sign:e.sun.sign,signDegree:e.sun.degree,signMinute:e.sun.minute})),e.moon&&t.push((0,H.A)((0,H.A)({id:"moon"},F.moon),{},{degree:e.moon.longitude||X(e.moon),sign:e.moon.sign,signDegree:e.moon.degree,signMinute:e.moon.minute})),e.ascendant&&t.push({id:"ascendant",symbol:"ASC",displayName:"上升",color:"#d35400",degree:e.ascendant.longitude||X(e.ascendant),sign:e.ascendant.sign,signDegree:e.ascendant.degree,signMinute:e.ascendant.minute,isAngle:!0}),t.map((function(e){return(0,H.A)((0,H.A)({},e),{},{svgAngle:N(e.degree)})}))}function B(e){for(var t=[],n=[{angle:0,aspectName:"合相",orb:8,color:"#FF6B6B"},{angle:60,aspectName:"六分相",orb:4,color:"#4ECDC4"},{angle:90,aspectName:"四分相",orb:6,color:"#FFE66D"},{angle:120,aspectName:"三分相",orb:6,color:"#4CAF50"},{angle:180,aspectName:"对分相",orb:8,color:"#9C27B0"}],o=0;o<e.length;o++)for(var a=o+1;a<e.length;a++){var r,i=e[o],s=e[a],c=Math.abs(i.degree-s.degree),l=Math.min(c,360-c),u=(0,z.A)(n);try{for(u.s();!(r=u.n()).done;){var d=r.value;if(Math.abs(l-d.angle)<=d.orb){t.push({planet1:i.id,planet2:s.id,aspect:d.aspectName,angle:d.angle,orb:Math.abs(l-d.angle),color:d.color,isApplying:!0});break}}}catch(p){u.e(p)}finally{u.f()}}return t}function K(){return{zodiac:I(),houses:[],planets:[(0,H.A)((0,H.A)({id:"sun"},F.sun),{},{degree:352.8,sign:"双鱼座",signDegree:13,signMinute:49,svgAngle:N(352.8)}),{id:"ascendant",symbol:"ASC",displayName:"上升",color:"#d35400",degree:64.2,sign:"双子座",signDegree:4,signMinute:11,svgAngle:N(64.2),isAngle:!0}],aspects:[],settings:{centerX:250,centerY:250,outerRadius:220,zodiacRadius:200,houseRadius:180,planetRadius:160,innerRadius:50}}}function Q(e){try{if(!e||!e.astrologyPositions)throw new Error("缺少占星位置数据");var t=e.astrologyPositions,n=t.ascendant.longitude||X(t.ascendant),o=I(),a=S(n),r=q(t),i=B(r);return{zodiac:o,houses:a,planets:r,aspects:i,settings:{centerX:250,centerY:250,outerRadius:220,zodiacRadius:200,houseRadius:180,planetRadius:160,innerRadius:50}}}catch(s){return console.error("星盘数据生成失败:",s),K()}}var j=["d","fill","fill-opacity","stroke","stroke-width"],O=["x1","y1","x2","y2","stroke"],Z=["x","y","fill","font-size"],T=["x","y","fill"];function Y(e,t,n,r,i,s){return(0,o.uX)(),(0,o.CE)("g",{class:"zodiac-sector",onMouseenter:t[0]||(t[0]=function(){return r.onHover&&r.onHover.apply(r,arguments)}),onMouseleave:t[1]||(t[1]=function(){return r.onLeave&&r.onLeave.apply(r,arguments)})},[(0,o.Lk)("path",{d:r.sectorPath,fill:n.zodiac.color,"fill-opacity":r.isHovered?.3:.15,stroke:n.zodiac.color,"stroke-width":r.isHovered?2:1,class:"sector-background"},null,8,j),(0,o.Lk)("line",{x1:r.innerPoint.x,y1:r.innerPoint.y,x2:r.outerPoint.x,y2:r.outerPoint.y,stroke:n.zodiac.color,"stroke-width":"1",opacity:"0.5",class:"sector-divider"},null,8,O),(0,o.Lk)("text",{x:r.symbolPosition.x,y:r.symbolPosition.y,fill:n.zodiac.color,"font-size":r.symbolSize,"font-weight":"bold","text-anchor":"middle","dominant-baseline":"middle",class:"zodiac-symbol"},(0,a.v_)(n.zodiac.symbol),9,Z),r.isHovered?((0,o.uX)(),(0,o.CE)("text",{key:0,x:r.namePosition.x,y:r.namePosition.y,fill:n.zodiac.color,"font-size":"11","font-weight":"500","text-anchor":"middle","dominant-baseline":"middle",class:"zodiac-name"},(0,a.v_)(n.zodiac.name),9,T)):(0,o.Q3)("",!0)],32)}n(8598);const V={name:"ZodiacSector",props:{zodiac:{type:Object,required:!0},center:{type:Number,required:!0},innerRadius:{type:Number,required:!0},outerRadius:{type:Number,required:!0}},setup:function(e){var t=(0,W.KR)(!1),n=(0,o.EW)((function(){var t=e.zodiac.svgAngle,n=t+30,o=t*Math.PI/180,a=n*Math.PI/180,r=e.center+e.innerRadius*Math.cos(o),i=e.center+e.innerRadius*Math.sin(o),s=e.center+e.outerRadius*Math.cos(o),c=e.center+e.outerRadius*Math.sin(o),l=e.center+e.outerRadius*Math.cos(a),u=e.center+e.outerRadius*Math.sin(a),d=e.center+e.innerRadius*Math.cos(a),p=e.center+e.innerRadius*Math.sin(a),h=n-t<=180?"0":"1";return["M ".concat(r," ").concat(i),"L ".concat(s," ").concat(c),"A ".concat(e.outerRadius," ").concat(e.outerRadius," 0 ").concat(h," 1 ").concat(l," ").concat(u),"L ".concat(d," ").concat(p),"A ".concat(e.innerRadius," ").concat(e.innerRadius," 0 ").concat(h," 0 ").concat(r," ").concat(i),"Z"].join(" ")})),a=(0,o.EW)((function(){var t=e.zodiac.svgAngle*Math.PI/180;return{x:e.center+e.innerRadius*Math.cos(t),y:e.center+e.innerRadius*Math.sin(t)}})),r=(0,o.EW)((function(){var t=e.zodiac.svgAngle*Math.PI/180;return{x:e.center+e.outerRadius*Math.cos(t),y:e.center+e.outerRadius*Math.sin(t)}})),i=(0,o.EW)((function(){var t=(e.zodiac.svgAngle+15)*Math.PI/180,n=e.outerRadius-10;return{x:e.center+n*Math.cos(t),y:e.center+n*Math.sin(t)}})),s=(0,o.EW)((function(){var t=(e.zodiac.svgAngle+15)*Math.PI/180,n=e.innerRadius+15;return{x:e.center+n*Math.cos(t),y:e.center+n*Math.sin(t)}})),c=(0,o.EW)((function(){var t=Math.min(e.outerRadius-e.innerRadius,20);return Math.max(.8*t,12)})),l=function(){t.value=!0},u=function(){t.value=!1};return{isHovered:t,sectorPath:n,innerPoint:a,outerPoint:r,symbolPosition:i,namePosition:s,symbolSize:c,onHover:l,onLeave:u}}};var G=n(1241);const J=(0,G.A)(V,[["render",Y],["__scopeId","data-v-6fddcf42"]]),U=J;var $=["d"],ee=["x1","y1","x2","y2","stroke-width","opacity"],te=["x","y","font-size","opacity"],ne={key:0,class:"house-tooltip"},oe=["x","y","width"],ae=["x","y"];function re(e,t,n,r,i,s){return(0,o.uX)(),(0,o.CE)("g",{class:"house-sector",onMouseenter:t[0]||(t[0]=function(){return r.onHover&&r.onHover.apply(r,arguments)}),onMouseleave:t[1]||(t[1]=function(){return r.onLeave&&r.onLeave.apply(r,arguments)})},[(0,o.Lk)("path",{d:r.sectorPath,fill:"transparent",stroke:"none",class:"house-background"},null,8,$),(0,o.Lk)("line",{x1:r.innerPoint.x,y1:r.innerPoint.y,x2:r.outerPoint.x,y2:r.outerPoint.y,stroke:"#6c757d","stroke-width":r.isHovered?2:1,opacity:r.isHovered?.8:.4,"stroke-dasharray":"2,2",class:"house-divider"},null,8,ee),(0,o.Lk)("text",{x:r.numberPosition.x,y:r.numberPosition.y,fill:"#495057","font-size":r.numberSize,"font-weight":"600","text-anchor":"middle","dominant-baseline":"middle",opacity:r.isHovered?1:.7,class:"house-number"},(0,a.v_)(n.house.number),9,te),r.isHovered?((0,o.uX)(),(0,o.CE)("g",ne,[(0,o.Lk)("rect",{x:r.tooltipPosition.x-r.tooltipWidth/2,y:r.tooltipPosition.y-10,width:r.tooltipWidth,height:"20",fill:"rgba(0,0,0,0.8)",rx:"3",class:"tooltip-background"},null,8,oe),(0,o.Lk)("text",{x:r.tooltipPosition.x,y:r.tooltipPosition.y,fill:"white","font-size":"10","font-weight":"500","text-anchor":"middle","dominant-baseline":"middle",class:"tooltip-text"},(0,a.v_)(r.houseDescription),9,ae)])):(0,o.Q3)("",!0)],32)}const ie={name:"HouseSector",props:{house:{type:Object,required:!0},center:{type:Number,required:!0},innerRadius:{type:Number,required:!0},outerRadius:{type:Number,required:!0}},setup:function(e){var t=(0,W.KR)(!1),n={1:"自我・个性",2:"财富・价值",3:"沟通・学习",4:"家庭・根源",5:"创造・恋爱",6:"工作・健康",7:"关系・合作",8:"转化・共享",9:"哲学・远行",10:"事业・声誉",11:"友谊・希望",12:"潜意识・牺牲"},a=(0,o.EW)((function(){var t=e.house.svgAngle,n=t+30,o=t*Math.PI/180,a=n*Math.PI/180,r=e.center+e.innerRadius*Math.cos(o),i=e.center+e.innerRadius*Math.sin(o),s=e.center+e.outerRadius*Math.cos(o),c=e.center+e.outerRadius*Math.sin(o),l=e.center+e.outerRadius*Math.cos(a),u=e.center+e.outerRadius*Math.sin(a),d=e.center+e.innerRadius*Math.cos(a),p=e.center+e.innerRadius*Math.sin(a),h=n-t<=180?"0":"1";return["M ".concat(r," ").concat(i),"L ".concat(s," ").concat(c),"A ".concat(e.outerRadius," ").concat(e.outerRadius," 0 ").concat(h," 1 ").concat(l," ").concat(u),"L ".concat(d," ").concat(p),"A ".concat(e.innerRadius," ").concat(e.innerRadius," 0 ").concat(h," 0 ").concat(r," ").concat(i),"Z"].join(" ")})),r=(0,o.EW)((function(){var t=e.house.svgAngle*Math.PI/180;return{x:e.center+e.innerRadius*Math.cos(t),y:e.center+e.innerRadius*Math.sin(t)}})),i=(0,o.EW)((function(){var t=e.house.svgAngle*Math.PI/180;return{x:e.center+e.outerRadius*Math.cos(t),y:e.center+e.outerRadius*Math.sin(t)}})),s=(0,o.EW)((function(){var t=(e.house.svgAngle+15)*Math.PI/180,n=(e.innerRadius+e.outerRadius)/2;return{x:e.center+n*Math.cos(t),y:e.center+n*Math.sin(t)}})),c=(0,o.EW)((function(){var t=(e.house.svgAngle+15)*Math.PI/180,n=e.outerRadius+20;return{x:e.center+n*Math.cos(t),y:e.center+n*Math.sin(t)}})),l=(0,o.EW)((function(){return n[e.house.number]||"第".concat(e.house.number,"宫")})),u=(0,o.EW)((function(){return 8*l.value.length+16})),d=(0,o.EW)((function(){var t=Math.min(e.outerRadius-e.innerRadius,16);return Math.max(.6*t,10)})),p=function(){t.value=!0},h=function(){t.value=!1};return{isHovered:t,sectorPath:a,innerPoint:r,outerPoint:i,numberPosition:s,tooltipPosition:c,houseDescription:l,tooltipWidth:u,numberSize:d,onHover:p,onLeave:h}}},se=(0,G.A)(ie,[["render",re],["__scopeId","data-v-6d9eb358"]]),ce=se;var le=["transform"],ue=["r","fill","fill-opacity","stroke","stroke-width"],de=["x2","y2","stroke"],pe=["fill","font-size"],he={key:0,class:"degree-label"},ve=["x","y","width","fill"],ge=["y"];function ye(e,t,n,r,i,s){return(0,o.uX)(),(0,o.CE)("g",{class:"planet-marker",onMouseenter:t[0]||(t[0]=function(){return r.onHover&&r.onHover.apply(r,arguments)}),onMouseleave:t[1]||(t[1]=function(){return r.onLeave&&r.onLeave.apply(r,arguments)}),transform:"translate(".concat(r.position.x,", ").concat(r.position.y,")")},[(0,o.Lk)("circle",{r:r.circleRadius,fill:n.planet.color,"fill-opacity":r.isHovered?.3:.1,stroke:n.planet.color,"stroke-width":r.isHovered?2:1,class:"planet-background"},null,8,ue),(0,o.Lk)("line",{x1:"0",y1:"0",x2:r.lineEnd.x,y2:r.lineEnd.y,stroke:n.planet.color,"stroke-width":"1",opacity:"0.6",class:"position-line"},null,8,de),(0,o.Lk)("text",{x:"0",y:"0",fill:n.planet.color,"font-size":r.symbolSize,"font-weight":"bold","text-anchor":"middle","dominant-baseline":"middle",class:"planet-symbol"},(0,a.v_)(n.planet.symbol),9,pe),r.isHovered?((0,o.uX)(),(0,o.CE)("g",he,[(0,o.Lk)("rect",{x:-r.labelWidth/2,y:r.circleRadius+5,width:r.labelWidth,height:"16",fill:n.planet.color,"fill-opacity":"0.9",rx:"3",class:"label-background"},null,8,ve),(0,o.Lk)("text",{x:"0",y:r.circleRadius+15,fill:"white","font-size":"10","font-weight":"500","text-anchor":"middle","dominant-baseline":"middle",class:"degree-text"},(0,a.v_)(r.degreeLabel),9,ge)])):(0,o.Q3)("",!0)],40,le)}const fe={name:"PlanetMarker",props:{planet:{type:Object,required:!0},center:{type:Number,required:!0},radius:{type:Number,required:!0}},emits:["planet-hover","planet-leave"],setup:function(e,t){var n=t.emit,a=(0,W.KR)(!1),r=(0,o.EW)((function(){var t=e.planet.svgAngle*Math.PI/180;return{x:e.center+e.radius*Math.cos(t),y:e.center+e.radius*Math.sin(t)}})),i=(0,o.EW)((function(){var t=e.planet.svgAngle*Math.PI/180,n=.3*e.radius;return{x:-n*Math.cos(t),y:-n*Math.sin(t)}})),s=(0,o.EW)((function(){return e.planet.isAngle?12:10})),c=(0,o.EW)((function(){return e.planet.isAngle?10:12})),l=(0,o.EW)((function(){return"".concat(e.planet.signDegree,"°").concat(e.planet.signMinute,"'")})),u=(0,o.EW)((function(){return 6*l.value.length+8})),d=function(t){a.value=!0,n("planet-hover",e.planet,t)},p=function(){a.value=!1,n("planet-leave")};return{isHovered:a,position:r,lineEnd:i,circleRadius:s,symbolSize:c,degreeLabel:l,labelWidth:u,onHover:d,onLeave:p}}},me=(0,G.A)(fe,[["render",ye],["__scopeId","data-v-a4cbb2fc"]]),xe=me;var be=["x1","y1","x2","y2","stroke","stroke-width","opacity","stroke-dasharray"],ke=["cx","cy","fill"],Me={key:1,class:"aspect-tooltip"},Re=["x","y","width"],Pe=["x","y"];function Ee(e,t,n,r,i,s){return(0,o.uX)(),(0,o.CE)("g",{class:"aspect-line",onMouseenter:t[0]||(t[0]=function(){return r.onHover&&r.onHover.apply(r,arguments)}),onMouseleave:t[1]||(t[1]=function(){return r.onLeave&&r.onLeave.apply(r,arguments)})},[(0,o.Lk)("line",{x1:r.startPoint.x,y1:r.startPoint.y,x2:r.endPoint.x,y2:r.endPoint.y,stroke:n.aspect.color,"stroke-width":r.lineWidth,opacity:r.lineOpacity,"stroke-dasharray":r.dashPattern,class:"aspect-connection"},null,8,be),r.isHovered?((0,o.uX)(),(0,o.CE)("circle",{key:0,cx:r.midPoint.x,cy:r.midPoint.y,r:3,fill:n.aspect.color,class:"aspect-marker"},null,8,ke)):(0,o.Q3)("",!0),r.isHovered?((0,o.uX)(),(0,o.CE)("g",Me,[(0,o.Lk)("rect",{x:r.tooltipPosition.x-r.tooltipWidth/2,y:r.tooltipPosition.y-12,width:r.tooltipWidth,height:"24",fill:"rgba(0,0,0,0.9)",rx:"4",class:"tooltip-background"},null,8,Re),(0,o.Lk)("text",{x:r.tooltipPosition.x,y:r.tooltipPosition.y,fill:"white","font-size":"10","font-weight":"500","text-anchor":"middle","dominant-baseline":"middle",class:"tooltip-text"},(0,a.v_)(r.aspectDescription),9,Pe)])):(0,o.Q3)("",!0)],32)}n(113),n(8111),n(116);const Ae={name:"AspectLine",props:{aspect:{type:Object,required:!0},planets:{type:Array,required:!0},center:{type:Number,required:!0},radius:{type:Number,required:!0}},setup:function(e){var t=(0,W.KR)(!1),n=(0,o.EW)((function(){return e.planets.find((function(t){return t.name===e.aspect.planet1}))})),a=(0,o.EW)((function(){return e.planets.find((function(t){return t.name===e.aspect.planet2}))})),r=(0,o.EW)((function(){if(!n.value)return{x:0,y:0};var t=n.value.svgAngle*Math.PI/180;return{x:e.center+e.radius*Math.cos(t),y:e.center+e.radius*Math.sin(t)}})),i=(0,o.EW)((function(){if(!a.value)return{x:0,y:0};var t=a.value.svgAngle*Math.PI/180;return{x:e.center+e.radius*Math.cos(t),y:e.center+e.radius*Math.sin(t)}})),s=(0,o.EW)((function(){return{x:(r.value.x+i.value.x)/2,y:(r.value.y+i.value.y)/2}})),c=(0,o.EW)((function(){var t=s.value.x,n=s.value.y-20,o=.9*e.center,a=Math.sqrt(Math.pow(t-e.center,2)+Math.pow(n-e.center,2));if(a>o){var r=Math.atan2(n-e.center,t-e.center);return{x:e.center+o*Math.cos(r),y:e.center+o*Math.sin(r)}}return{x:t,y:n}})),l=(0,o.EW)((function(){var t={合相:{width:2,opacity:.8,dash:"none"},六分相:{width:1.5,opacity:.6,dash:"3,2"},四分相:{width:2,opacity:.7,dash:"5,3"},三分相:{width:1.5,opacity:.6,dash:"none"},对分相:{width:2,opacity:.8,dash:"2,2"}};return t[e.aspect.aspect]||{width:1,opacity:.5,dash:"none"}})),u=(0,o.EW)((function(){return t.value?l.value.width+1:l.value.width})),d=(0,o.EW)((function(){return t.value?l.value.opacity+.2:l.value.opacity})),p=(0,o.EW)((function(){return l.value.dash})),h=(0,o.EW)((function(){var t,o,r=(null===(t=n.value)||void 0===t?void 0:t.name)||e.aspect.planet1,i=(null===(o=a.value)||void 0===o?void 0:o.name)||e.aspect.planet2,s="".concat(e.aspect.orb.toFixed(1),"°");return"".concat(r," ").concat(e.aspect.aspect," ").concat(i," (").concat(s,")")})),v=(0,o.EW)((function(){return Math.max(6*h.value.length,120)})),g=function(){t.value=!0},y=function(){t.value=!1};return{isHovered:t,startPoint:r,endPoint:i,midPoint:s,tooltipPosition:c,lineWidth:u,lineOpacity:d,dashPattern:p,aspectDescription:h,tooltipWidth:v,onHover:g,onLeave:y}}},Le=(0,G.A)(Ae,[["render",Ee],["__scopeId","data-v-48e68821"]]),we=Le,De={name:"StarChart",components:{ZodiacSector:U,HouseSector:ce,PlanetMarker:xe,AspectLine:we},props:{calculationResults:{type:Object,required:!0},size:{type:Number,default:500}},setup:function(e){var t=(0,W.KR)(!1),n=(0,W.KR)(!0),a=(0,W.KR)(null),r=(0,W.KR)({x:0,y:0}),i=(0,o.EW)((function(){return e.size})),s=(0,o.EW)((function(){return i.value/2})),c=(0,o.EW)((function(){try{return Q(e.calculationResults)}catch(t){return console.error("生成星盘数据失败:",t),g()}})),l=(0,o.EW)((function(){return{outerRadius:.44*i.value,zodiacRadius:.4*i.value,houseRadius:.36*i.value,planetRadius:.32*i.value,innerRadius:.1*i.value}})),u=(0,o.EW)((function(){return a.value?{left:"".concat(r.value.x+10,"px"),top:"".concat(r.value.y-30,"px"),display:"block"}:{}})),d=function(){t.value=!t.value},p=function(){n.value=!n.value},h=function(e,t){if(a.value=e,t){var n=t.target.closest("svg").getBoundingClientRect();r.value={x:t.clientX-n.left,y:t.clientY-n.top}}},v=function(){a.value=null},g=function(){return{zodiac:[],houses:[],planets:[],aspects:[],settings:l.value}};return(0,o.sV)((function(){console.log("星盘组件已挂载，数据:",c.value)})),{showAspects:t,showHouses:n,hoveredPlanet:a,chartSize:i,center:s,chartData:c,settings:l,tooltipStyle:u,toggleAspects:d,toggleHouses:p,onPlanetHover:h,onPlanetLeave:v}}},Ce=(0,G.A)(De,[["render",C],["__scopeId","data-v-ff03e71a"]]),We=Ce},9868:(e,t,n)=>{var o=n(6518),a=n(9504),r=n(1291),i=n(1240),s=n(2333),c=n(9039),l=RangeError,u=String,d=Math.floor,p=a(s),h=a("".slice),v=a(1..toFixed),g=function(e,t,n){return 0===t?n:t%2===1?g(e,t-1,n*e):g(e*e,t/2,n)},y=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},f=function(e,t,n){var o=-1,a=n;while(++o<6)a+=t*e[o],e[o]=a%1e7,a=d(a/1e7)},m=function(e,t){var n=6,o=0;while(--n>=0)o+=e[n],e[n]=d(o/t),o=o%t*1e7},x=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var o=u(e[t]);n=""===n?o:n+p("0",7-o.length)+o}return n},b=c((function(){return"0.000"!==v(8e-5,3)||"1"!==v(.9,0)||"1.25"!==v(1.255,2)||"1000000000000000128"!==v(0xde0b6b3a7640080,0)}))||!c((function(){v({})}));o({target:"Number",proto:!0,forced:b},{toFixed:function(e){var t,n,o,a,s=i(this),c=r(e),d=[0,0,0,0,0,0],v="",b="0";if(c<0||c>20)throw new l("Incorrect fraction digits");if(s!==s)return"NaN";if(s<=-1e21||s>=1e21)return u(s);if(s<0&&(v="-",s=-s),s>1e-21)if(t=y(s*g(2,69,1))-69,n=t<0?s*g(2,-t,1):s/g(2,t,1),n*=4503599627370496,t=52-t,t>0){f(d,0,n),o=c;while(o>=7)f(d,1e7,0),o-=7;f(d,g(10,o,1),0),o=t-1;while(o>=23)m(d,1<<23),o-=23;m(d,1<<o),f(d,1,1),m(d,2),b=x(d)}else f(d,0,n),f(d,1<<-t,0),b=x(d)+p("0",c);return c>0?(a=b.length,b=v+(a<=c?"0."+p("0",c-a)+b:h(b,0,a-c)+"."+h(b,a-c))):b=v+b,b}})}}]);
//# sourceMappingURL=457.ed4e487b.js.map