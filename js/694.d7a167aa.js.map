{"version":3,"file":"js/694.d7a167aa.js","mappings":"6cAYMA,EAAgB,CACpBC,IAAK,CAAEC,OAAQ,OAAQC,KAAM,MAC7BC,KAAM,CAAEF,OAAQ,MAAOC,KAAM,MAC7BE,QAAS,CAAEH,OAAQ,MAAOC,KAAM,MAChCG,MAAO,CAAEJ,OAAQ,MAAOC,KAAM,MAC9BI,KAAM,CAAEL,OAAQ,OAAQC,KAAM,MAC9BK,QAAS,CAAEN,OAAQ,QAASC,KAAM,MAClCM,OAAQ,CAAEP,OAAQ,SAAUC,KAAM,MAClCO,OAAQ,CAAER,OAAQ,QAASC,KAAM,OACjCQ,QAAS,CAAET,OAAQ,MAAOC,KAAM,OAChCS,MAAO,CAAEV,OAAQ,MAAOC,KAAM,QAI1BU,EAAgB,CACpBC,GAAI,CAAEC,MAAO,EAAGC,IAAK,EAAGC,UAAW,SAAUC,KAAM,eACnDC,IAAK,CAAEJ,MAAO,GAAIC,IAAK,EAAGC,UAAW,WAAYC,KAAM,WACvDE,IAAK,CAAEL,MAAO,GAAIC,IAAK,EAAGC,UAAW,SAAUC,KAAM,UACrDG,IAAK,CAAEN,MAAO,IAAKC,IAAK,EAAGC,UAAW,SAAUC,KAAM,SACtDI,IAAK,CAAEP,MAAO,IAAKC,IAAK,EAAGC,UAAW,SAAUC,KAAM,eAIlDK,EAAc,CAClBC,gBAAiB,CAAEC,IAAK,GAAIC,SAAU,EAAGvB,KAAM,WAC/CwB,iBAAkB,CAAEF,IAAK,GAAIC,SAAU,EAAGvB,KAAM,WAChDyB,iBAAkB,CAAEH,IAAK,GAAIC,SAAU,EAAGvB,KAAM,WAChD0B,iBAAkB,CAAEJ,IAAK,GAAIC,SAAU,EAAGvB,KAAM,WAChD2B,iBAAkB,CAAEL,IAAK,GAAIC,SAAU,EAAGvB,KAAM,WAChD4B,kBAAmB,CAAEN,IAAK,GAAIC,SAAU,EAAGvB,KAAM,QACjD6B,gBAAiB,CAAEP,IAAK,GAAIC,SAAU,EAAGvB,KAAM,YAMjD,SAAS8B,EAAyBC,EAAQC,GACxC,IAAIC,EAAOC,KAAKC,IAAIJ,EAASC,GAI7B,OAHIC,EAAO,MACTA,EAAO,IAAMA,GAERA,CACT,CAKA,SAASG,EAAcC,EAAaC,EAAazB,GAC/C,OAAOqB,KAAKC,IAAIE,EAAcC,IAAgBzB,CAChD,CAKA,SAAS0B,EAAsBC,GAC7B,IACE,MAAwB,kBAAbA,EACFA,EAGLA,GAAgC,YAApBC,EAAAA,EAAAA,GAAOD,QAEME,IAAvBF,EAASG,UACJH,EAASG,WAIXC,EAAAA,EAAAA,IAAwBJ,IAGjCK,QAAQC,KAAK,WAAYN,GAClB,EACT,CAAE,MAAOO,GAEP,OADAF,QAAQE,MAAM,UAAWA,EAAOP,GACzB,CACT,CACF,CAKA,SAASQ,EAAwBC,EAAgBC,GAC/C,IAAMC,EAAU,GAEhB,IAmCE,OAjCAC,OAAOC,KAAKH,GAAkBI,SAAQ,SAAAC,GACpC,GAAsB,cAAlBA,EAAJ,CAEA,IAAMC,EAAaN,EAAiBK,GAC9BE,EAAgBlB,EAAsBiB,GAG5CJ,OAAOC,KAAKJ,GAAgBK,SAAQ,SAAAI,GAClC,IAAMC,EAAWV,EAAeS,GAC1BE,EAAcrB,EAAsBoB,GAEpCE,EAAY/B,EAAyB2B,EAAeG,GAG1DR,OAAOU,QAAQpD,GAAe4C,SAAQ,SAAAS,GAA8B,IACFC,EAAAC,EADEC,GAAAC,EAAAA,EAAAA,GAAAJ,EAAA,GAA5BK,EAAUF,EAAA,GAAEG,EAAUH,EAAA,GACxD9B,EAAcyB,EAAWQ,EAAWzD,MAAOyD,EAAWxD,MACxDsC,EAAQmB,KAAK,CACXf,eAA2C,QAA5BS,EAAAnE,EAAc0D,UAAc,IAAAS,OAAA,EAA5BA,EAA8BhE,OAAQuD,EACrDG,aAAuC,QAA1BO,EAAApE,EAAc6D,UAAY,IAAAO,OAAA,EAA1BA,EAA4BjE,OAAQ0D,EACjDa,OAAQH,EACRvD,IAAKqB,KAAKC,IAAI0B,EAAYQ,EAAWzD,OACrCE,UAAWuD,EAAWvD,UACtBC,KAAMsD,EAAWtD,KACjByD,SAAUf,EAAgBG,EAC1Ba,YAAajB,EAAWkB,MAAQ,KAChCC,UAAWhB,EAASe,MAAQ,MAGlC,GACF,GA5ByC,CA6B3C,IAGOvB,EAAQyB,MAAK,SAACC,EAAGC,GAAC,OAAKD,EAAEhE,IAAMiE,EAAEjE,GAAG,GAE7C,CAAE,MAAOkC,GAEP,OADAF,QAAQE,MAAM,aAAcA,GACrB,EACT,CACF,CAKA,SAASgC,EAAqBC,EAAWC,GACvC,IACE,IAAMC,EAAY,IAAIC,KAAKH,GAAWI,UAChCC,EAAe,IAAIF,KAAKF,GAAcG,UACtCE,GAAcD,EAAeH,GAAa,SAE1CK,EAAgB,GAetB,OAbAnC,OAAOU,QAAQ1C,GAAakC,SAAQ,SAAAkC,GAA2B,IAAAC,GAAAtB,EAAAA,EAAAA,GAAAqB,EAAA,GAAzBE,EAAQD,EAAA,GAAEE,EAASF,EAAA,GACjDG,EAAaD,EAAUrE,IAAMqE,EAAUpE,SAAW,EAClDsE,EAAWF,EAAUrE,IAAMqE,EAAUpE,SAAW,EAElD+D,GAAcM,GAAcN,GAAcO,GAC5CN,EAAcjB,MAAIwB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACfH,GAAS,IACZI,IAAKL,EACLM,UAAWV,EAAaM,GAAcD,EAAUpE,WAGtD,IAEOgE,CACT,CAAE,MAAOxC,GAEP,OADAF,QAAQE,MAAM,aAAcA,GACrB,EACT,CACF,CAKA,SAASkD,EAA6B1B,GACpC,IAAM2B,EAAkB,CAEtB,QAAS,CACPC,SAAU,2BACVC,YAAa,wBAEf,SAAU,CACRD,SAAU,yBACVC,YAAa,sBAEf,SAAU,CACRD,SAAU,uBACVC,YAAa,sBAIf,QAAS,CACPD,SAAU,yBACVC,YAAa,uBAEf,SAAU,CACRD,SAAU,wBACVC,YAAa,kBAIf,QAAS,CACPD,SAAU,uBACVC,YAAa,kBAEf,SAAU,CACRD,SAAU,oBACVC,YAAa,oBAIf,QAAS,CACPD,SAAU,wBACVC,YAAa,mBAEf,SAAU,CACRD,SAAU,oBACVC,YAAa,kBAEf,SAAU,CACRD,SAAU,sBACVC,YAAa,oBAIf,SAAU,CACRD,SAAU,wBACVC,YAAa,oBAEf,UAAW,CACTD,SAAU,qBACVC,YAAa,qBAIf,SAAU,CACRD,SAAU,oBACVC,YAAa,oBAEf,UAAW,CACTD,SAAU,oBACVC,YAAa,oBAIXL,EAAM,GAAHM,OAAM9B,EAAOhB,cAAa,KAAA8C,OAAI9B,EAAOA,QACxC+B,EAAiBJ,EAAgBH,GAEvC,IAAKO,EACH,MAAO,GAAPD,OAAU9B,EAAOhB,eAAa8C,OAAG9B,EAAOA,QAAM8B,OAAG9B,EAAOb,YAAW,sBAAA2C,OAAqB9B,EAAO1D,IAAI0F,QAAQ,GAAE,MAI/G,IAAMC,EAAa,CAAC,MAAO,OAAOC,SAASlC,EAAOA,QAClD,OAAO+B,EAAeE,EAAa,WAAa,cAClD,CAKA,SAASE,EAA4BvD,EAASwD,GAC5C,IAAMC,EAAqBzD,EAAQ0D,QAAO,SAAAtC,GAAM,MAC9C,CAAC,KAAM,MAAO,MAAO,OAAOkC,SAASlC,EAAOhB,cAAc,IAGtDuD,EAAW,CACfxG,OAAQ,GACRC,OAAQ,GACRC,QAAS,GACTC,MAAO,IAmBT,OAhBAmG,EAAmBtD,SAAQ,SAAAiB,GACzB,IAAMwC,EAAY,CAChB,GAAM,SACN,IAAO,SACP,IAAO,UACP,IAAO,SACPxC,EAAOhB,eAELwD,GACFD,EAASC,GAAWzC,MAAIwB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACrBvB,GAAM,IACT+B,eAAgBL,EAA6B1B,KAGnD,KAEAuB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACKgB,GAAQ,IACXE,QAASC,EAA0BN,IAEvC,CAKA,SAASM,EAA0B3F,GACjC,OAAIA,GAAO,IAAMA,GAAO,GACf,CACL4F,MAAO,QACPC,YAAa,oDACbC,UAAW,CAAC,WAAY,OAAQ,SAAU,SAEnC9F,GAAO,IAAMA,GAAO,GACtB,CACL4F,MAAO,QACPC,YAAa,oCACbC,UAAW,CAAC,OAAQ,OAAQ,OAAQ,SAE7B9F,GAAO,IAAMA,GAAO,GACtB,CACL4F,MAAO,QACPC,YAAa,kCACbC,UAAW,CAAC,OAAQ,OAAQ,OAAQ,SAG/B,CACLF,MAAO,QACPC,YAAa,iCACbC,UAAW,CAAC,OAAQ,OAAQ,OAAQ,QAG1C,CAKO,SAASC,EAAsBC,EAAWC,GAC/C,IACE1E,QAAQ2E,IAAI,cACZ3E,QAAQ2E,IAAI,QAASF,GACrBzE,QAAQ2E,IAAI,QAASD,GAGrB1E,QAAQ2E,IAAI,iBACZ,IAAMvE,GAAiBwE,EAAAA,EAAAA,IAA4BH,GACnDzE,QAAQ2E,IAAI,SAAUvE,GAGtBJ,QAAQ2E,IAAI,iBACZ,IAAME,GAAe5B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAChBwB,GAAS,IACZK,kBAAmBJ,IAEfrE,GAAmBuE,EAAAA,EAAAA,IAA4BC,GACrD7E,QAAQ2E,IAAI,SAAUtE,GAGtB,IAAMgC,EAAY,IAAIC,KAAKmC,EAAUK,mBAC/BC,EAAc,IAAIzC,KAAKoC,GACvBjC,GAAcsC,EAAc1C,GAAa,SAC/CrC,QAAQ2E,IAAI,QAASlC,GAGrBzC,QAAQ2E,IAAI,gBACZ,IAAMrE,EAAUH,EAAwBC,EAAgBC,GACxDL,QAAQ2E,IAAI,QAASrE,GAGrBN,QAAQ2E,IAAI,gBACZ,IAAMjC,EAAgBR,EAAqBuC,EAAUK,kBAAmBJ,GACxE1E,QAAQ2E,IAAI,UAAWjC,GAGvB1C,QAAQ2E,IAAI,iBACZ,IAAMK,EAAsBnB,EAA4BvD,EAASmC,GACjEzC,QAAQ2E,IAAI,SAAUK,GAEtB,IAAMC,EAAS,CACbR,UAAAA,EACAC,YAAAA,EACAjG,IAAKY,KAAK6F,MAAMzC,GAChBrC,eAAAA,EACAC,iBAAAA,EACAC,QAASA,EAAQ6E,MAAM,EAAG,IAC1BzC,cAAAA,EACAsC,oBAAAA,EACAI,SAAU,CACRC,iBAAiB,IAAI/C,MAAOgD,cAC5BC,YAAajF,EAAQkF,OACrBC,aAAcnF,EAAQ0D,QAAO,SAAAhC,GAAC,MAAoB,WAAhBA,EAAE/D,SAAsB,IAAEuH,SAKhE,OADAxF,QAAQ2E,IAAI,aACLM,CAET,CAAE,MAAO/E,GAGP,MAFAF,QAAQE,MAAM,aAAcA,GAC5BF,QAAQE,MAAM,QAASA,EAAMwF,OACvB,IAAIC,MAAM,YAADnC,OAAatD,EAAM0F,SACpC,CACF,CAKO,SAASC,EAAsBC,GACpC,IACE,IAAQrH,EAAqDqH,EAArDrH,IAAK6B,EAAgDwF,EAAhDxF,QAASoC,EAAuCoD,EAAvCpD,cAAesC,EAAwBc,EAAxBd,oBAE/Be,EAAS,CACb5B,QAAS,GAAFX,OAAK/E,EAAG,aAAA+E,OAAYlD,EAAQkF,OAAM,gBACzCQ,aAAchB,EAAoBb,QAClCsB,aAAcnF,EAAQ6E,MAAM,EAAG,GAAGc,KAAI,SAAAvE,GAAM,MAAK,CAC/CwE,MAAO,GAAF1C,OAAK9B,EAAOhB,cAAa,KAAA8C,OAAI9B,EAAOA,OAAM,KAAA8B,OAAI9B,EAAOb,aAC1DyD,YAAalB,EAA6B1B,GAC1C1D,IAAK0D,EAAO1D,IACZC,UAAWyD,EAAOzD,UACnB,IACDkI,WAAYzD,EAAcuD,KAAI,SAAAG,GAAK,MAAK,CACtCjJ,KAAMiJ,EAAMjJ,KACZgG,SAAU9D,KAAKgH,MAAuB,IAAjBD,EAAMjD,UAC3BmB,YAAa,OAAFd,OAAS4C,EAAMjJ,KAAI,QAAAqG,OAAOnE,KAAKgH,MAAuB,IAAjBD,EAAMjD,UAAe,KACtE,IACDmD,gBAAiBC,EAAwBT,IAG3C,OAAOC,CACT,CAAE,MAAO7F,GAEP,MADAF,QAAQE,MAAM,YAAaA,GACrBA,CACR,CACF,CAKA,SAASqG,EAAwBT,GAC/B,IACE,IAAQxF,EAAYwF,EAAZxF,QACFgG,EAAkB,GAGlBb,EAAenF,EAAQ0D,QAAO,SAAAhC,GAAC,MAAoB,WAAhBA,EAAE/D,SAAsB,IAAEkH,MAAM,EAAG,GAwB5E,OAtBAM,EAAahF,SAAQ,SAAAiB,GACU,OAAzBA,EAAOhB,cACT4F,EAAgB7E,KAAK,CACnB+E,KAAM,QACNC,OAAQ,uCACRC,UAAW,aAEqB,OAAzBhF,EAAOhB,cAChB4F,EAAgB7E,KAAK,CACnB+E,KAAM,QACNC,OAAQ,8BACRC,UAAW,YAEqB,QAAzBhF,EAAOhB,eAChB4F,EAAgB7E,KAAK,CACnB+E,KAAM,QACNC,OAAQ,kCACRC,UAAW,UAGjB,IAEOJ,CACT,CAAE,MAAOpG,GAEP,OADAF,QAAQE,MAAM,UAAWA,GAClB,EACT,CACF,C,iBC9cA,IAAIyG,EAAI,EAAQ,MACZC,EAAc,EAAQ,MACtBC,EAAsB,EAAQ,MAC9BC,EAAkB,EAAQ,MAC1BC,EAAU,EAAQ,MAClBC,EAAQ,EAAQ,MAEhBC,EAAcC,WACdC,EAAUC,OACVlC,EAAQ7F,KAAK6F,MACbmC,EAAST,EAAYG,GACrBO,EAAcV,EAAY,GAAGzB,OAC7BoC,EAAgBX,EAAY,GAAIlD,SAEhC8D,EAAM,SAAUC,EAAGC,EAAGC,GACxB,OAAa,IAAND,EAAUC,EAAMD,EAAI,IAAM,EAAIF,EAAIC,EAAGC,EAAI,EAAGC,EAAMF,GAAKD,EAAIC,EAAIA,EAAGC,EAAI,EAAGC,EAClF,EAEIhD,EAAM,SAAU8C,GAClB,IAAIC,EAAI,EACJE,EAAKH,EACT,MAAOG,GAAM,KACXF,GAAK,GACLE,GAAM,KAER,MAAOA,GAAM,EACXF,GAAK,EACLE,GAAM,EACN,OAAOF,CACX,EAEIG,EAAW,SAAUC,EAAMJ,EAAGK,GAChC,IAAIC,GAAS,EACTC,EAAKF,EACT,QAASC,EAAQ,EACfC,GAAMP,EAAII,EAAKE,GACfF,EAAKE,GAASC,EAAK,IACnBA,EAAK/C,EAAM+C,EAAK,IAEpB,EAEIC,EAAS,SAAUJ,EAAMJ,GAC3B,IAAIM,EAAQ,EACRD,EAAI,EACR,QAASC,GAAS,EAChBD,GAAKD,EAAKE,GACVF,EAAKE,GAAS9C,EAAM6C,EAAIL,GACxBK,EAAKA,EAAIL,EAAK,GAElB,EAEIS,EAAe,SAAUL,GAC3B,IAAIE,EAAQ,EACRI,EAAI,GACR,QAASJ,GAAS,EAChB,GAAU,KAANI,GAAsB,IAAVJ,GAA+B,IAAhBF,EAAKE,GAAc,CAChD,IAAIK,EAAIlB,EAAQW,EAAKE,IACrBI,EAAU,KAANA,EAAWC,EAAID,EAAIf,EAAO,IAAK,EAAIgB,EAAE7C,QAAU6C,CACrD,CACA,OAAOD,CACX,EAEIE,EAAStB,GAAM,WACjB,MAAqC,UAA9BO,EAAc,KAAS,IACF,MAA1BA,EAAc,GAAK,IACS,SAA5BA,EAAc,MAAO,IACuB,wBAA5CA,EAAc,kBAAuB,EACzC,MAAOP,GAAM,WAEXO,EAAc,CAAC,EACjB,IAIAZ,EAAE,CAAE4B,OAAQ,SAAUC,OAAO,EAAMC,OAAQH,GAAU,CACnD5E,QAAS,SAAiBgF,GACxB,IAKIC,EAAGC,EAAGC,EAAGC,EALTC,EAASjC,EAAgBkC,MACzBC,EAAcpC,EAAoB6B,GAClCZ,EAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GACvBjG,EAAO,GACPoD,EAAS,IAIb,GAAIgE,EAAc,GAAKA,EAAc,GAAI,MAAM,IAAIhC,EAAY,6BAE/D,GAAI8B,IAAWA,EAAQ,MAAO,MAC9B,GAAIA,IAAW,MAAQA,GAAU,KAAM,OAAO5B,EAAQ4B,GAKtD,GAJIA,EAAS,IACXlH,EAAO,IACPkH,GAAUA,GAERA,EAAS,MAKX,GAJAJ,EAAIhE,EAAIoE,EAASvB,EAAI,EAAG,GAAI,IAAM,GAClCoB,EAAID,EAAI,EAAII,EAASvB,EAAI,GAAImB,EAAG,GAAKI,EAASvB,EAAI,EAAGmB,EAAG,GACxDC,GAAK,iBACLD,EAAI,GAAKA,EACLA,EAAI,EAAG,CACTd,EAASC,EAAM,EAAGc,GAClBC,EAAII,EACJ,MAAOJ,GAAK,EACVhB,EAASC,EAAM,IAAK,GACpBe,GAAK,EAEPhB,EAASC,EAAMN,EAAI,GAAIqB,EAAG,GAAI,GAC9BA,EAAIF,EAAI,EACR,MAAOE,GAAK,GACVX,EAAOJ,EAAM,GAAK,IAClBe,GAAK,GAEPX,EAAOJ,EAAM,GAAKe,GAClBhB,EAASC,EAAM,EAAG,GAClBI,EAAOJ,EAAM,GACb7C,EAASkD,EAAaL,EACxB,MACED,EAASC,EAAM,EAAGc,GAClBf,EAASC,EAAM,IAAMa,EAAG,GACxB1D,EAASkD,EAAaL,GAAQT,EAAO,IAAK4B,GAU5C,OAPEA,EAAc,GAChBH,EAAI7D,EAAOO,OACXP,EAASpD,GAAQiH,GAAKG,EAClB,KAAO5B,EAAO,IAAK4B,EAAcH,GAAK7D,EACtCqC,EAAYrC,EAAQ,EAAG6D,EAAIG,GAAe,IAAM3B,EAAYrC,EAAQ6D,EAAIG,KAE5EhE,EAASpD,EAAOoD,EACTA,CACX,G","sources":["webpack://meiban-app/./src/utils/transitCalculator.js","webpack://meiban-app/./node_modules/core-js/modules/es.number.to-fixed.js"],"sourcesContent":["/**\r\n * 行运盘计算模块\r\n * 计算行运行星位置，分析相位关系，生成运势报告\r\n */\r\n\r\n// 正确导入现有模块的函数\r\nimport { \r\n  calculateAstrologyPositions,\r\n  calculateDegreeFromSign,\r\n} from './calculator.js';\r\n\r\n// 行星周期数据\r\nconst PLANET_CYCLES = {\r\n  sun: { period: 365.25, name: '太阳' },\r\n  moon: { period: 29.53, name: '月亮' },\r\n  mercury: { period: 87.97, name: '水星' },\r\n  venus: { period: 224.7, name: '金星' },\r\n  mars: { period: 686.98, name: '火星' },\r\n  jupiter: { period: 4332.59, name: '木星' }, // 11.86年\r\n  saturn: { period: 10759.22, name: '土星' }, // 29.46年\r\n  uranus: { period: 30688.5, name: '天王星' }, // 84年\r\n  neptune: { period: 60182, name: '海王星' }, // 164.8年\r\n  pluto: { period: 90560, name: '冥王星' }  // 248年\r\n};\r\n\r\n// 相位配置\r\nconst ASPECT_CONFIG = {\r\n  合相: { angle: 0, orb: 8, intensity: 'strong', type: 'conjunction' },\r\n  六分相: { angle: 60, orb: 4, intensity: 'moderate', type: 'sextile' },\r\n  四分相: { angle: 90, orb: 6, intensity: 'strong', type: 'square' },\r\n  三分相: { angle: 120, orb: 6, intensity: 'strong', type: 'trine' },\r\n  对分相: { angle: 180, orb: 8, intensity: 'strong', type: 'opposition' }\r\n};\r\n\r\n// 重要年龄节点配置\r\nconst LIFE_CYCLES = {\r\n  saturn_return_1: { age: 29, duration: 2, name: '第一次土星回归' },\r\n  jupiter_return_1: { age: 12, duration: 1, name: '第一次木星回归' },\r\n  jupiter_return_2: { age: 24, duration: 1, name: '第二次木星回归' },\r\n  jupiter_return_3: { age: 36, duration: 1, name: '第三次木星回归' },\r\n  jupiter_return_4: { age: 48, duration: 1, name: '第四次木星回归' },\r\n  saturn_opposition: { age: 44, duration: 2, name: '土星对冲' },\r\n  saturn_return_2: { age: 58, duration: 2, name: '第二次土星回归' }\r\n};\r\n\r\n/**\r\n * 计算两个角度之间的差值\r\n */\r\nfunction calculateAngleDifference(angle1, angle2) {\r\n  let diff = Math.abs(angle1 - angle2);\r\n  if (diff > 180) {\r\n    diff = 360 - diff;\r\n  }\r\n  return diff;\r\n}\r\n\r\n/**\r\n * 判断相位是否在容许度范围内\r\n */\r\nfunction isAspectValid(actualAngle, aspectAngle, orb) {\r\n  return Math.abs(actualAngle - aspectAngle) <= orb;\r\n}\r\n\r\n/**\r\n * 安全的度数计算函数 - 处理可能的数据格式问题\r\n */\r\nfunction safeDegreeCalculation(position) {\r\n  try {\r\n    if (typeof position === 'number') {\r\n      return position;\r\n    }\r\n    \r\n    if (position && typeof position === 'object') {\r\n      // 如果已经有 longitude 属性，直接使用\r\n      if (position.longitude !== undefined) {\r\n        return position.longitude;\r\n      }\r\n      \r\n      // 否则从星座信息计算\r\n      return calculateDegreeFromSign(position);\r\n    }\r\n    \r\n    console.warn('无效的位置数据:', position);\r\n    return 0;\r\n  } catch (error) {\r\n    console.error('度数计算错误:', error, position);\r\n    return 0;\r\n  }\r\n}\r\n\r\n/**\r\n * 计算行运相位\r\n */\r\nfunction calculateTransitAspects(natalPositions, transitPositions) {\r\n  const aspects = [];\r\n\r\n  try {\r\n    // 遍历行运行星\r\n    Object.keys(transitPositions).forEach(transitPlanet => {\r\n      if (transitPlanet === 'ascendant') return; // 跳过上升点\r\n\r\n      const transitPos = transitPositions[transitPlanet];\r\n      const transitDegree = safeDegreeCalculation(transitPos);\r\n\r\n      // 遍历本命行星\r\n      Object.keys(natalPositions).forEach(natalPlanet => {\r\n        const natalPos = natalPositions[natalPlanet];\r\n        const natalDegree = safeDegreeCalculation(natalPos);\r\n\r\n        const angleDiff = calculateAngleDifference(transitDegree, natalDegree);\r\n\r\n        // 检查每种相位\r\n        Object.entries(ASPECT_CONFIG).forEach(([aspectName, aspectData]) => {\r\n          if (isAspectValid(angleDiff, aspectData.angle, aspectData.orb)) {\r\n            aspects.push({\r\n              transitPlanet: PLANET_CYCLES[transitPlanet]?.name || transitPlanet,\r\n              natalPlanet: PLANET_CYCLES[natalPlanet]?.name || natalPlanet,\r\n              aspect: aspectName,\r\n              orb: Math.abs(angleDiff - aspectData.angle),\r\n              intensity: aspectData.intensity,\r\n              type: aspectData.type,\r\n              applying: transitDegree < natalDegree, // 简化判断\r\n              transitSign: transitPos.sign || '未知',\r\n              natalSign: natalPos.sign || '未知'\r\n            });\r\n          }\r\n        });\r\n      });\r\n    });\r\n\r\n    // 按容许度排序，精确相位优先\r\n    return aspects.sort((a, b) => a.orb - b.orb);\r\n    \r\n  } catch (error) {\r\n    console.error('计算行运相位时出错:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * 计算当前年龄所处的生命周期\r\n */\r\nfunction getCurrentLifeCycles(birthDate, analysisDate) {\r\n  try {\r\n    const birthTime = new Date(birthDate).getTime();\r\n    const analysisTime = new Date(analysisDate).getTime();\r\n    const ageInYears = (analysisTime - birthTime) / (1000 * 60 * 60 * 24 * 365.25);\r\n\r\n    const currentCycles = [];\r\n    \r\n    Object.entries(LIFE_CYCLES).forEach(([cycleKey, cycleData]) => {\r\n      const cycleStart = cycleData.age - cycleData.duration / 2;\r\n      const cycleEnd = cycleData.age + cycleData.duration / 2;\r\n      \r\n      if (ageInYears >= cycleStart && ageInYears <= cycleEnd) {\r\n        currentCycles.push({\r\n          ...cycleData,\r\n          key: cycleKey,\r\n          progress: (ageInYears - cycleStart) / cycleData.duration\r\n        });\r\n      }\r\n    });\r\n\r\n    return currentCycles;\r\n  } catch (error) {\r\n    console.error('计算生命周期时出错:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n/**\r\n * 根据相位生成解读文本\r\n */\r\nfunction generateAspectInterpretation(aspect) {\r\n  const interpretations = {\r\n    // 月亮相位\r\n    '月亮-合相': {\r\n      positive: '情绪和直觉得到强化，是开始新的情感周期的好时机。',\r\n      challenging: '情绪可能较为强烈，需要学会平衡内在感受。'\r\n    },\r\n    '月亮-三分相': {\r\n      positive: '情感流动顺畅，与他人的关系和谐，直觉力增强。',\r\n      challenging: '过度依赖情感判断，可能忽略理性分析。'\r\n    },\r\n    '月亮-四分相': {\r\n      positive: '情感挑战促进内在成长，学会处理复杂情绪。',\r\n      challenging: '情绪波动较大，人际关系可能出现紧张。'\r\n    },\r\n\r\n    // 水星相位\r\n    '水星-合相': {\r\n      positive: '思维敏锐，沟通能力增强，学习新事物的好时机。',\r\n      challenging: '思绪过于活跃，可能导致焦虑或决策困难。'\r\n    },\r\n    '水星-三分相': {\r\n      positive: '逻辑思维清晰，表达能力强，适合谈判和学习。',\r\n      challenging: '可能过于理性，忽略情感因素。'\r\n    },\r\n\r\n    // 金星相位  \r\n    '金星-合相': {\r\n      positive: '魅力增强，人际关系改善，艺术创造力提升。',\r\n      challenging: '可能过于注重外表或物质享受。'\r\n    },\r\n    '金星-三分相': {\r\n      positive: '爱情运佳，社交活跃，审美品味提升。',\r\n      challenging: '可能过于追求和谐，避免必要冲突。'\r\n    },\r\n\r\n    // 土星相位\r\n    '土星-合相': {\r\n      positive: '建立稳固基础，承担重要责任，获得长期成就。',\r\n      challenging: '压力增大，可能感到限制和负担。'\r\n    },\r\n    '土星-三分相': {\r\n      positive: '通过努力获得稳定成果，责任感增强。',\r\n      challenging: '可能过于保守，缺乏冒险精神。'\r\n    },\r\n    '土星-四分相': {\r\n      positive: '通过挑战获得成长，建立更强的自律能力。',\r\n      challenging: '面临重要考验，需要做出艰难决定。'\r\n    },\r\n\r\n    // 天王星相位\r\n    '天王星-合相': {\r\n      positive: '突破旧有模式，迎来革命性变化，创新能力强。',\r\n      challenging: '变化来得突然，可能带来不稳定感。'\r\n    },\r\n    '天王星-四分相': {\r\n      positive: '被迫改变促进个人成长，获得新的自由。',\r\n      challenging: '面临突发变故，原有计划可能被打乱。'\r\n    },\r\n\r\n    // 海王星相位\r\n    '海王星-合相': {\r\n      positive: '精神觉醒，直觉增强，艺术灵感丰富。',\r\n      challenging: '现实感模糊，可能出现迷惑或逃避。'\r\n    },\r\n    '海王星-三分相': {\r\n      positive: '灵性成长，同理心增强，创造力提升。',\r\n      challenging: '可能过于理想化，忽视现实问题。'\r\n    }\r\n  };\r\n\r\n  const key = `${aspect.transitPlanet}-${aspect.aspect}`;\r\n  const interpretation = interpretations[key];\r\n  \r\n  if (!interpretation) {\r\n    return `${aspect.transitPlanet}${aspect.aspect}${aspect.natalPlanet}：这个相位带来重要的能量交流，容许度${aspect.orb.toFixed(1)}度。`;\r\n  }\r\n\r\n  // 根据相位类型选择正面或挑战性解读\r\n  const isPositive = ['三分相', '六分相'].includes(aspect.aspect);\r\n  return interpretation[isPositive ? 'positive' : 'challenging'];\r\n}\r\n\r\n/**\r\n * 生成外行星影响分析\r\n */\r\nfunction generateOuterPlanetAnalysis(aspects, currentAge) {\r\n  const outerPlanetAspects = aspects.filter(aspect => \r\n    ['土星', '天王星', '海王星', '冥王星'].includes(aspect.transitPlanet)\r\n  );\r\n\r\n  const analysis = {\r\n    saturn: [],\r\n    uranus: [],\r\n    neptune: [],\r\n    pluto: []\r\n  };\r\n\r\n  outerPlanetAspects.forEach(aspect => {\r\n    const planetKey = {\r\n      '土星': 'saturn',\r\n      '天王星': 'uranus', \r\n      '海王星': 'neptune',\r\n      '冥王星': 'pluto'\r\n    }[aspect.transitPlanet];\r\n\r\n    if (planetKey) {\r\n      analysis[planetKey].push({\r\n        ...aspect,\r\n        interpretation: generateAspectInterpretation(aspect)\r\n      });\r\n    }\r\n  });\r\n\r\n  return {\r\n    ...analysis,\r\n    summary: generateLifePhaseAnalysis(currentAge)\r\n  };\r\n}\r\n\r\n/**\r\n * 生成人生阶段分析\r\n */\r\nfunction generateLifePhaseAnalysis(age) {\r\n  if (age >= 42 && age <= 46) {\r\n    return {\r\n      phase: '中年转化期',\r\n      description: '正处于人生的重要转折点，外行星的影响促使您重新评估人生方向和价值观。这是一个深度内省和转化的时期。',\r\n      keyThemes: ['责任与自由的平衡', '内在蜕变', '事业重新定位', '精神觉醒']\r\n    };\r\n  } else if (age >= 28 && age <= 32) {\r\n    return {\r\n      phase: '成年确立期',\r\n      description: '土星回归带来成年责任的确立，这是从青年过渡到成熟成年人的关键时期。',\r\n      keyThemes: ['承担责任', '建立基础', '确立方向', '成熟成长']\r\n    };\r\n  } else if (age >= 35 && age <= 37) {\r\n    return {\r\n      phase: '扩展成长期', \r\n      description: '木星回归带来新的成长机遇和视野扩展，是追求更高目标的良好时期。',\r\n      keyThemes: ['机遇扩展', '视野开阔', '学习成长', '积极进取']\r\n    };\r\n  } else {\r\n    return {\r\n      phase: '稳定发展期',\r\n      description: '当前处于相对稳定的发展阶段，适合巩固既有成果并为未来做准备。',\r\n      keyThemes: ['稳定发展', '积累经验', '完善技能', '准备机遇']\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * 计算完整的行运盘数据\r\n */\r\nexport function calculateTransitChart(birthData, transitDate) {\r\n  try {\r\n    console.log('🌟 开始计算行运盘');\r\n    console.log('出生数据:', birthData);\r\n    console.log('行运日期:', transitDate);\r\n\r\n    // 计算本命盘位置\r\n    console.log('📍 计算本命盘位置...');\r\n    const natalPositions = calculateAstrologyPositions(birthData);\r\n    console.log('本命盘位置:', natalPositions);\r\n    \r\n    // 计算行运盘位置\r\n    console.log('📍 计算行运盘位置...');\r\n    const transitUserData = {\r\n      ...birthData,\r\n      fullBirthDateTime: transitDate\r\n    };\r\n    const transitPositions = calculateAstrologyPositions(transitUserData);\r\n    console.log('行运盘位置:', transitPositions);\r\n\r\n    // 计算年龄\r\n    const birthTime = new Date(birthData.fullBirthDateTime);\r\n    const transitTime = new Date(transitDate);\r\n    const ageInYears = (transitTime - birthTime) / (1000 * 60 * 60 * 24 * 365.25);\r\n    console.log('当前年龄:', ageInYears);\r\n\r\n    // 计算相位\r\n    console.log('📍 计算相位关系...');\r\n    const aspects = calculateTransitAspects(natalPositions, transitPositions);\r\n    console.log('相位关系:', aspects);\r\n\r\n    // 获取当前生命周期\r\n    console.log('📍 分析生命周期...');\r\n    const currentCycles = getCurrentLifeCycles(birthData.fullBirthDateTime, transitDate);\r\n    console.log('当前生命周期:', currentCycles);\r\n\r\n    // 生成外行星分析\r\n    console.log('📍 生成外行星分析...');\r\n    const outerPlanetAnalysis = generateOuterPlanetAnalysis(aspects, ageInYears);\r\n    console.log('外行星分析:', outerPlanetAnalysis);\r\n\r\n    const result = {\r\n      birthData,\r\n      transitDate,\r\n      age: Math.floor(ageInYears),\r\n      natalPositions,\r\n      transitPositions,\r\n      aspects: aspects.slice(0, 10), // 取前10个最重要的相位\r\n      currentCycles,\r\n      outerPlanetAnalysis,\r\n      metadata: {\r\n        calculationTime: new Date().toISOString(),\r\n        aspectCount: aspects.length,\r\n        majorAspects: aspects.filter(a => a.intensity === 'strong').length\r\n      }\r\n    };\r\n\r\n    console.log('✅ 行运盘计算完成');\r\n    return result;\r\n\r\n  } catch (error) {\r\n    console.error('❌ 行运盘计算失败:', error);\r\n    console.error('错误堆栈:', error.stack);\r\n    throw new Error(`行运盘计算失败: ${error.message}`);\r\n  }\r\n}\r\n\r\n/**\r\n * 生成行运报告文本\r\n */\r\nexport function generateTransitReport(transitData) {\r\n  try {\r\n    const { age, aspects, currentCycles, outerPlanetAnalysis } = transitData;\r\n    \r\n    const report = {\r\n      summary: `${age}岁的行运分析显示了${aspects.length}个重要相位正在发生作用。`,\r\n      currentPhase: outerPlanetAnalysis.summary,\r\n      majorAspects: aspects.slice(0, 5).map(aspect => ({\r\n        title: `${aspect.transitPlanet} ${aspect.aspect} ${aspect.natalPlanet}`,\r\n        description: generateAspectInterpretation(aspect),\r\n        orb: aspect.orb,\r\n        intensity: aspect.intensity\r\n      })),\r\n      lifeCycles: currentCycles.map(cycle => ({\r\n        name: cycle.name,\r\n        progress: Math.round(cycle.progress * 100),\r\n        description: `正在经历${cycle.name}，完成度${Math.round(cycle.progress * 100)}%`\r\n      })),\r\n      recommendations: generateRecommendations(transitData)\r\n    };\r\n\r\n    return report;\r\n  } catch (error) {\r\n    console.error('生成行运报告失败:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * 生成建议\r\n */\r\nfunction generateRecommendations(transitData) {\r\n  try {\r\n    const { aspects } = transitData;\r\n    const recommendations = [];\r\n\r\n    // 基于主要相位的建议\r\n    const majorAspects = aspects.filter(a => a.intensity === 'strong').slice(0, 3);\r\n    \r\n    majorAspects.forEach(aspect => {\r\n      if (aspect.transitPlanet === '土星') {\r\n        recommendations.push({\r\n          area: '责任与结构',\r\n          advice: '这是建立长期基础的重要时期，虽然可能面临压力，但坚持下去会有稳固的收获。',\r\n          timeframe: '未来6-12个月'\r\n        });\r\n      } else if (aspect.transitPlanet === '木星') {\r\n        recommendations.push({\r\n          area: '成长与机遇',\r\n          advice: '积极把握扩展机会，这是学习新技能和拓展视野的良好时机。',\r\n          timeframe: '未来3-6个月'\r\n        });\r\n      } else if (aspect.transitPlanet === '天王星') {\r\n        recommendations.push({\r\n          area: '变化与创新',\r\n          advice: '拥抱变化，不要抗拒突如其来的转变，它们可能带来意想不到的机遇。',\r\n          timeframe: '未来1-2年'\r\n        });\r\n      }\r\n    });\r\n\r\n    return recommendations;\r\n  } catch (error) {\r\n    console.error('生成建议失败:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n// 导出配置常量\r\nexport { PLANET_CYCLES, ASPECT_CONFIG, LIFE_CYCLES };","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar thisNumberValue = require('../internals/this-number-value');\nvar $repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar $RangeError = RangeError;\nvar $String = String;\nvar floor = Math.floor;\nvar repeat = uncurryThis($repeat);\nvar stringSlice = uncurryThis(''.slice);\nvar nativeToFixed = uncurryThis(1.0.toFixed);\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar multiply = function (data, n, c) {\n  var index = -1;\n  var c2 = c;\n  while (++index < 6) {\n    c2 += n * data[index];\n    data[index] = c2 % 1e7;\n    c2 = floor(c2 / 1e7);\n  }\n};\n\nvar divide = function (data, n) {\n  var index = 6;\n  var c = 0;\n  while (--index >= 0) {\n    c += data[index];\n    data[index] = floor(c / n);\n    c = (c % n) * 1e7;\n  }\n};\n\nvar dataToString = function (data) {\n  var index = 6;\n  var s = '';\n  while (--index >= 0) {\n    if (s !== '' || index === 0 || data[index] !== 0) {\n      var t = $String(data[index]);\n      s = s === '' ? t : s + repeat('0', 7 - t.length) + t;\n    }\n  } return s;\n};\n\nvar FORCED = fails(function () {\n  return nativeToFixed(0.00008, 3) !== '0.000' ||\n    nativeToFixed(0.9, 0) !== '1' ||\n    nativeToFixed(1.255, 2) !== '1.25' ||\n    nativeToFixed(1000000000000000128.0, 0) !== '1000000000000000128';\n}) || !fails(function () {\n  // V8 ~ Android 4.3-\n  nativeToFixed({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.es/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toIntegerOrInfinity(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    // TODO: ES2018 increased the maximum number of fraction digits to 100, need to improve the implementation\n    if (fractDigits < 0 || fractDigits > 20) throw new $RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (number !== number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return $String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(data, 0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(data, 1e7, 0);\n          j -= 7;\n        }\n        multiply(data, pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(data, 1 << 23);\n          j -= 23;\n        }\n        divide(data, 1 << j);\n        multiply(data, 1, 1);\n        divide(data, 2);\n        result = dataToString(data);\n      } else {\n        multiply(data, 0, z);\n        multiply(data, 1 << -e, 0);\n        result = dataToString(data) + repeat('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat('0', fractDigits - k) + result\n        : stringSlice(result, 0, k - fractDigits) + '.' + stringSlice(result, k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n"],"names":["PLANET_CYCLES","sun","period","name","moon","mercury","venus","mars","jupiter","saturn","uranus","neptune","pluto","ASPECT_CONFIG","合相","angle","orb","intensity","type","六分相","四分相","三分相","对分相","LIFE_CYCLES","saturn_return_1","age","duration","jupiter_return_1","jupiter_return_2","jupiter_return_3","jupiter_return_4","saturn_opposition","saturn_return_2","calculateAngleDifference","angle1","angle2","diff","Math","abs","isAspectValid","actualAngle","aspectAngle","safeDegreeCalculation","position","_typeof","undefined","longitude","calculateDegreeFromSign","console","warn","error","calculateTransitAspects","natalPositions","transitPositions","aspects","Object","keys","forEach","transitPlanet","transitPos","transitDegree","natalPlanet","natalPos","natalDegree","angleDiff","entries","_ref","_PLANET_CYCLES$transi","_PLANET_CYCLES$natalP","_ref2","_slicedToArray","aspectName","aspectData","push","aspect","applying","transitSign","sign","natalSign","sort","a","b","getCurrentLifeCycles","birthDate","analysisDate","birthTime","Date","getTime","analysisTime","ageInYears","currentCycles","_ref3","_ref4","cycleKey","cycleData","cycleStart","cycleEnd","_objectSpread","key","progress","generateAspectInterpretation","interpretations","positive","challenging","concat","interpretation","toFixed","isPositive","includes","generateOuterPlanetAnalysis","currentAge","outerPlanetAspects","filter","analysis","planetKey","summary","generateLifePhaseAnalysis","phase","description","keyThemes","calculateTransitChart","birthData","transitDate","log","calculateAstrologyPositions","transitUserData","fullBirthDateTime","transitTime","outerPlanetAnalysis","result","floor","slice","metadata","calculationTime","toISOString","aspectCount","length","majorAspects","stack","Error","message","generateTransitReport","transitData","report","currentPhase","map","title","lifeCycles","cycle","round","recommendations","generateRecommendations","area","advice","timeframe","$","uncurryThis","toIntegerOrInfinity","thisNumberValue","$repeat","fails","$RangeError","RangeError","$String","String","repeat","stringSlice","nativeToFixed","pow","x","n","acc","x2","multiply","data","c","index","c2","divide","dataToString","s","t","FORCED","target","proto","forced","fractionDigits","e","z","j","k","number","this","fractDigits"],"sourceRoot":""}