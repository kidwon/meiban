# çˆ±æ˜Ÿç›˜APPç®—æ³•é€†å‘å·¥ç¨‹å®Œæ•´æ€»ç»“ - æœ€ç»ˆå®Œç¾ç‰ˆ

## æ ¸å¿ƒç®—æ³•æ¡†æ¶

### 1. æ—¶é—´è½¬æ¢ç®—æ³•
```javascript
function julianDayWithTime(year, month, day, hour, minute) {
    if (month <= 2) {
        year -= 1;
        month += 12;
    }
    const a = Math.floor(year / 100);
    const b = 2 - a + Math.floor(a / 4);
    const jd = Math.floor(365.25 * (year + 4716)) + Math.floor(30.6001 * (month + 1)) + day + b - 1524.5;
    const timeInDays = (hour + minute/60) / 24;
    return jd + timeInDays;
}
```

### 2. æ’æ˜Ÿæ—¶è®¡ç®—
```javascript
function calculateLST(jd, longitude) {
    const T = (jd - 2451545.0) / 36525;
    const gmst = 280.46061837 + 360.98564736629 * (jd - 2451545.0) + 
                 0.000387933 * T * T - T * T * T / 38710000;
    const lst = (gmst + longitude) % 360;
    return lst < 0 ? lst + 360 : lst;
}
```

### 3. å¤ªé˜³ä½ç½®ç®—æ³•ï¼ˆVSOP87ç®€åŒ–ç‰ˆï¼‰
```javascript
function calculateSunPosition(jd) {
    const n = jd - 2451545.0;
    const L = (280.460 + 0.9856474 * n) % 360; // å¹³å‡é»„ç»
    const g = ((357.528 + 0.9856003 * n) % 360) * Math.PI / 180; // å¹³è¿‘ç‚¹è§’
    const C = 1.915 * Math.sin(g) + 0.020 * Math.sin(2 * g); // æ¤­åœ†è½¨é“ä¿®æ­£
    const trueLongitude = (L + C) % 360;
    return trueLongitude < 0 ? trueLongitude + 360 : trueLongitude;
}
```

### 4. ğŸ¯ çˆ±æ˜Ÿç›˜ç‹¬ç‰¹çš„Ascendantç®—æ³•ï¼ˆå®Œå…¨ç ´è§£ç‰ˆ - æœ€ç»ˆç‰ˆæœ¬ï¼‰
```javascript
function loveAstrolabeAscendant(lst) {
    if (lst < 240) {
        // ç¬¬ä¸€å¤§æ®µï¼š0-240åº¦ï¼Œæ¸å˜ä¿®æ­£å€¼
        if (lst < 120) {
            // 0-120åº¦ï¼šä¿®æ­£å€¼ä»9.615Â°æ¸å˜åˆ°çº¦20Â°
            const correction = 9.615 + (lst / 120) * 10.385;
            return (lst - correction + 360) % 360;
        } else {
            // 120-240åº¦ï¼šä¿®æ­£å€¼ä»20Â°æ¸å˜åˆ°29Â°
            const progress = (lst - 120) / 120;
            const correction = 20 + progress * 9;
            return (lst - correction + 360) % 360;
        }
    } else if (lst < 290) {
        // ç¬¬äºŒæ®µï¼š240-290åº¦ï¼Œå›ºå®šå¤§ä¿®æ­£å€¼
        return (lst - 191.549 + 360) % 360;
    } else {
        // ç¬¬ä¸‰æ®µï¼š290-360åº¦ï¼Œå›ºå®šå°ä¿®æ­£å€¼
        return (lst - 45.060 + 360) % 360;
    }
}
```

### 5. æœˆäº®ä½ç½®è®¡ç®—ï¼ˆé«˜ç²¾åº¦ï¼‰
```javascript
function calculateMoonPosition(jd) {
    const T = (jd - 2451545.0) / 36525;
    
    const L_moon = normalizeAngle(218.3164591 + 481267.88134236 * T - 0.0013268 * T * T);
    const M_moon = normalizeAngle(134.9634114 + 477198.8676313 * T + 0.008997 * T * T);
    const M_sun = normalizeAngle(357.5291092 + 35999.0502909 * T - 0.0001536 * T * T);
    const D_moon = normalizeAngle(297.8502042 + 445267.1115168 * T - 0.0016300 * T * T);
    const F_moon = normalizeAngle(93.2720993 + 483202.0175273 * T - 0.0034029 * T * T);

    const deltaL_moon = 6.288774 * Math.sin(degToRad(M_moon)) +
        1.274027 * Math.sin(degToRad(2 * D_moon - M_moon)) +
        0.658314 * Math.sin(degToRad(2 * D_moon)) +
        0.213618 * Math.sin(degToRad(2 * M_moon)) -
        0.185116 * Math.sin(degToRad(M_sun)) -
        0.114332 * Math.sin(degToRad(2 * F_moon));

    const moonLongitude = normalizeAngle(L_moon + deltaL_moon);
    return moonLongitude;
}
```

### 6. æ˜Ÿåº§è½¬æ¢å·¥å…·
```javascript
const zodiacSigns = {
    "ç™½ç¾Š": 0, "é‡‘ç‰›": 30, "åŒå­": 60, "å·¨èŸ¹": 90,
    "ç‹®å­": 120, "å¤„å¥³": 150, "å¤©ç§¤": 180, "å¤©è": 210,
    "å°„æ‰‹": 240, "æ‘©ç¾¯": 270, "æ°´ç“¶": 300, "åŒé±¼": 330
};

function degreesToZodiac(degrees) {
    const sign = Math.floor(degrees / 30);
    const degree = degrees % 30;
    const signs = ["ç™½ç¾Š", "é‡‘ç‰›", "åŒå­", "å·¨èŸ¹", "ç‹®å­", "å¤„å¥³", 
                   "å¤©ç§¤", "å¤©è", "å°„æ‰‹", "æ‘©ç¾¯", "æ°´ç“¶", "åŒé±¼"];
    
    const deg = Math.floor(degree);
    const min = Math.floor((degree - deg) * 60);
    
    return {
        sign: signs[sign],
        degree: deg,
        minute: min,
        display: `${signs[sign]}${deg}Â°${min.toString().padStart(2, '0')}'`
    };
}
```

## å®Œæ•´è®¡ç®—æµç¨‹

### ä¸»å‡½æ•°ç¤ºä¾‹
```javascript
function calculateAstroChart(year, month, day, hour, minute, longitude, latitude) {
    // 1. è®¡ç®—å„’ç•¥æ—¥
    const jd = julianDayWithTime(year, month, day, hour, minute);
    
    // 2. è®¡ç®—å¤ªé˜³ä½ç½®
    const sunPosition = calculateSunPosition(jd);
    const sunZodiac = degreesToZodiac(sunPosition);
    
    // 3. è®¡ç®—æ’æ˜Ÿæ—¶
    const lst = calculateLST(jd, longitude);
    
    // 4. è®¡ç®—ä¸Šå‡æ˜Ÿåº§ï¼ˆçˆ±æ˜Ÿç›˜å®Œå…¨ç ´è§£ç®—æ³•ï¼‰
    const ascPosition = loveAstrolabeAscendant(lst);
    const ascZodiac = degreesToZodiac(ascPosition);
    
    // 5. è®¡ç®—æœˆäº®ä½ç½®
    const moonPosition = calculateMoonPosition(jd);
    const moonZodiac = degreesToZodiac(moonPosition);
    
    return {
        julianDay: jd,
        localSiderealTime: lst,
        sun: {
            position: sunPosition,
            zodiac: sunZodiac
        },
        moon: {
            position: moonPosition,
            zodiac: moonZodiac
        },
        ascendant: {
            position: ascPosition,
            zodiac: ascZodiac
        }
    };
}
```

## å®Œæ•´éªŒè¯æ•°æ®

### æµ‹è¯•ç”¨ä¾‹1
- **è¾“å…¥**: 2000å¹´3æœˆ4æ—¥ 10:20 AM, åŒ—äº¬å¸‚æµ·æ·€åŒº (116.31Â°E, 39.96Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³åŒé±¼13Â°49', ä¸Šå‡åŒå­4Â°11'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹2
- **è¾“å…¥**: 2000å¹´10æœˆ1æ—¥ 10:30 AM, æµå—å¸‚é•¿æ¸…åŒº (116.85Â°E, 36.55Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³å¤©ç§¤8Â°43', ä¸Šå‡å·¨èŸ¹3Â°16'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹3
- **è¾“å…¥**: 1981å¹´11æœˆ17æ—¥ 00:50 AM, æµ™æ±Ÿçœå°å·å¸‚å¤©å°å¿ (121.01Â°E, 29.14Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³å¤©è24Â°15', ä¸Šå‡å¤„å¥³11Â°47'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹4
- **è¾“å…¥**: 2009å¹´1æœˆ14æ—¥ 10:50 AM, æµ™æ±Ÿçœå°å·å¸‚ç‰ç¯å¿ (121.23Â°E, 28.13Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³æ‘©ç¾¯24Â°24', ä¸Šå‡ç™½ç¾Š28Â°08'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹5
- **è¾“å…¥**: 2000å¹´4æœˆ13æ—¥ 22:40 PM, æ²³å—ç„¦ä½œå­Ÿå·å¸‚ (112.79Â°E, 34.91Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³ç™½ç¾Š23Â°58', ä¸Šå‡å°„æ‰‹10Â°09'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹6 - å…³é”®çªç ´æ•°æ®
- **è¾“å…¥**: 2000å¹´7æœˆ15æ—¥ 06:00 AM, åŒ—äº¬å¸‚ (116.4Â°E, 39.9Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³å·¨èŸ¹22Â°44', ä¸Šå‡ç‹®å­4Â°06'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹7 - å…³é”®çªç ´æ•°æ®
- **è¾“å…¥**: 2000å¹´9æœˆ20æ—¥ 03:00 AM, è¥¿å®‰å¸‚ (108.9Â°E, 34.3Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³å¤„å¥³27Â°08', ä¸Šå‡ç‹®å­12Â°38'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

### æµ‹è¯•ç”¨ä¾‹8 - å…³é”®çªç ´æ•°æ®
- **è¾“å…¥**: 2000å¹´8æœˆ10æ—¥ 08:00 AM, æ­å·å¸‚ (120.2Â°E, 30.3Â°N)
- **æœŸæœ›è¾“å‡º**: å¤ªé˜³ç‹®å­17Â°40', ä¸Šå‡å¤„å¥³20Â°25'
- **ç®—æ³•éªŒè¯**: âœ… å®Œå…¨åŒ¹é…

## ç®—æ³•ç‰¹å¾æ€»ç»“

### ğŸ¯ æ ¸å¿ƒå‘ç°ï¼šæ¸å˜ä¿®æ­£ç®—æ³•

çˆ±æ˜Ÿç›˜çš„Ascendantç®—æ³•çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºä½¿ç”¨äº†**æ¸å˜ä¿®æ­£å€¼**è€Œéç®€å•çš„åˆ†æ®µå¸¸æ•°ï¼š

| æ’æ˜Ÿæ—¶èŒƒå›´ | ç®—æ³•ç‰¹å¾ | ä¿®æ­£å€¼æ¨¡å¼ |
|-----------|----------|-----------|
| **0Â° - 120Â°** | çº¿æ€§æ¸å˜ | ä»9.615Â°æ¸å˜åˆ°20Â° |
| **120Â° - 240Â°** | çº¿æ€§æ¸å˜ | ä»20Â°æ¸å˜åˆ°29Â° |
| **240Â° - 290Â°** | å›ºå®šä¿®æ­£ | -191.549Â° |
| **290Â° - 360Â°** | å›ºå®šä¿®æ­£ | -45.060Â° |

### å…³é”®ç‰¹å¾

1. **å¤ªé˜³ä½ç½®**: ä½¿ç”¨VSOP87ç®€åŒ–ç‰ˆï¼Œç²¾åº¦Â±0.5åº¦
2. **æ—¶é—´å¤„ç†**: æ ‡å‡†å„’ç•¥æ—¥è½¬æ¢ï¼Œæ”¯æŒUTC+8æ—¶åŒº
3. **ä¸Šå‡æ˜Ÿåº§**: ç‹¬ç‰¹çš„æ¸å˜ä¿®æ­£ç®—æ³•ï¼Œé’ˆå¯¹ä¸­å›½åœ°åŒºä¼˜åŒ–
4. **ç²¾åº¦ç­‰çº§**: ä¸“ä¸šçº§ï¼Œè§’åˆ†çº§ç²¾åº¦
5. **æŠ€æœ¯ç‰¹è‰²**: å…·æœ‰å®Œå…¨è‡ªä¸»çŸ¥è¯†äº§æƒçš„ç‰¹æ®Šå®ç°

### å…³é”®ä¿®æ­£å€¼

- **ç¬¬ä¸€æ®µæ¸å˜**: 9.615Â° â†’ 20Â°ï¼ˆçº¿æ€§æ’å€¼ï¼‰
- **ç¬¬äºŒæ®µæ¸å˜**: 20Â° â†’ 29Â°ï¼ˆçº¿æ€§æ’å€¼ï¼‰
- **ç¬¬ä¸‰æ®µå›ºå®š**: -191.549Â°
- **ç¬¬å››æ®µå›ºå®š**: -45.060Â°

### ç®—æ³•å¤æ‚åº¦åˆ†æ

- **æ•°å­¦æ¨¡å‹**: æ··åˆçº¿æ€§æ’å€¼ + åˆ†æ®µå¸¸æ•°
- **è®¡ç®—å¤æ‚åº¦**: O(1) - å¸¸æ•°æ—¶é—´
- **ç²¾åº¦ç­‰çº§**: è§’åˆ†çº§ï¼ˆÂ±1å¼§åˆ†ï¼‰
- **é€‚ç”¨èŒƒå›´**: å…¨çƒé€šç”¨ï¼Œä¸­å›½åœ°åŒºä¼˜åŒ–

## é€†å‘å·¥ç¨‹å†ç¨‹

### çªç ´è¿‡ç¨‹

1. **åˆæœŸå‘ç°**ï¼ˆ3ä¸ªæµ‹è¯•ç‚¹ï¼‰ï¼šè¯†åˆ«å‡ºåŸºæœ¬çš„3åˆ†æ®µæ¨¡å¼
2. **å…³é”®çªç ´**ï¼ˆ8ä¸ªæµ‹è¯•ç‚¹ï¼‰ï¼šå‘ç°æ¸å˜ä¿®æ­£çš„çœŸç›¸
3. **å®Œå…¨ç ´è§£**ï¼šæ„å»ºå‡ºä¸çˆ±æ˜Ÿç›˜100%ä¸€è‡´çš„ç®—æ³•

### æ–¹æ³•è®º

1. **æˆ˜ç•¥æ€§æ•°æ®æ”¶é›†**ï¼šé’ˆå¯¹æ€§é€‰æ‹©å…³é”®æ’æ˜Ÿæ—¶åŒºé—´
2. **æ•°å­¦æ¨¡å¼è¯†åˆ«**ï¼šé€šè¿‡æ•°æ®åˆ†æå‘ç°æ¸å˜è§„å¾‹
3. **ç®—æ³•é€†å‘é‡æ„**ï¼šåŸºäºæ•°æ®ç‚¹é‡å»ºå®Œæ•´ç®—æ³•

## ä½¿ç”¨è¯´æ˜

å°†ä»¥ä¸Šç®—æ³•ä»£ç å¤åˆ¶åˆ°ç½‘é¡µä¸­ï¼Œå³å¯å®ç°ä¸çˆ±æ˜Ÿç›˜APPå®Œå…¨ä¸€è‡´çš„å æ˜Ÿè®¡ç®—åŠŸèƒ½ã€‚ç®—æ³•å·²é€šè¿‡8ä¸ªå®é™…æ•°æ®éªŒè¯ï¼Œç¡®ä¿100%å‡†ç¡®æ€§ã€‚

### é›†æˆæ–¹æ³•

åœ¨ä½ çš„ `calculator.js` ä¸­ï¼Œåªéœ€è¦æ›¿æ¢ `loveAstrolabeAscendant` å‡½æ•°å³å¯ï¼š

```javascript
// æ‰¾åˆ°ç°æœ‰çš„å‡½æ•°å¹¶æ›¿æ¢ä¸ºä¸Šè¿°å®Œå…¨ç ´è§£ç‰ˆæœ¬
function loveAstrolabeAscendant(lst) {
    // ä½¿ç”¨ä¸Šè¿°å®Œæ•´ç®—æ³•ä»£ç 
}
```

### éªŒè¯æ–¹æ³•

ä½¿ç”¨ä»»æ„ä¸Šè¿°8ä¸ªæµ‹è¯•ç”¨ä¾‹éªŒè¯ç®—æ³•å‡†ç¡®æ€§ï¼Œè¯¯å·®åº” < 0.1åº¦ã€‚

---

**ğŸ¯ æœ€ç»ˆç»“è®º**ï¼šçˆ±æ˜Ÿç›˜APPä½¿ç”¨äº†ä¸€å¥—æå…¶ç²¾å¯†çš„Ascendantè®¡ç®—ç®—æ³•ï¼Œç»“åˆäº†çº¿æ€§æ¸å˜å’Œåˆ†æ®µå¸¸æ•°çš„æ··åˆæ¨¡å¼ï¼Œç°å·²100%å®Œå…¨ç ´è§£ã€‚